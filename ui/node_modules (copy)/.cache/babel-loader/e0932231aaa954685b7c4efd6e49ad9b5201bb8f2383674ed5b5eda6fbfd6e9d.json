{"ast":null,"code":"var _jsxFileName = \"/home/brandon/security/learning/defi/uniswapv3-src/uniswapv3-code/ui/src/components/SwapForm.js\",\n  _s = $RefreshSig$();\nimport './SwapForm.css';\nimport { ethers } from 'ethers';\nimport { useContext, useEffect, useState } from 'react';\nimport { uint256Max } from '../lib/constants';\nimport { MetaMaskContext } from '../contexts/MetaMask';\nimport config from \"../config.js\";\nimport debounce from '../lib/debounce';\nimport AddLiquidityForm from './AddLiquidityForm';\nimport RemoveLiquidityForm from './RemoveLiquidityForm';\nimport PathFinder from '../lib/pathFinder';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst pairsToTokens = pairs => {\n  const tokens = pairs.reduce((acc, pair) => {\n    acc[pair.token0.address] = {\n      symbol: pair.token0.symbol,\n      address: pair.token0.address,\n      selected: false\n    };\n    acc[pair.token1.address] = {\n      symbol: pair.token1.symbol,\n      address: pair.token1.address,\n      selected: false\n    };\n    return acc;\n  }, {});\n  return Object.keys(tokens).map(k => tokens[k]);\n};\nconst countPathTokens = path => (path.length - 1) / 2 + 1;\nconst pathToTypes = path => {\n  return [\"address\"].concat(new Array(countPathTokens(path) - 1).fill([\"uint24\", \"address\"]).flat());\n};\nconst SwapInput = _ref => {\n  let {\n    token,\n    tokens,\n    onChange,\n    amount,\n    setAmount,\n    disabled,\n    readOnly\n  } = _ref;\n  return /*#__PURE__*/_jsxDEV(\"fieldset\", {\n    className: \"SwapInput\",\n    disabled: disabled,\n    children: [/*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"text\",\n      id: token + \"_amount\",\n      placeholder: \"0.0\",\n      value: amount,\n      onChange: ev => setAmount(ev.target.value),\n      readOnly: readOnly\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 40,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n      name: \"token\",\n      value: token,\n      onChange: onChange,\n      children: tokens.map(t => /*#__PURE__*/_jsxDEV(\"option\", {\n        children: t.symbol\n      }, `${token}_${t.symbol}`, false, {\n        fileName: _jsxFileName,\n        lineNumber: 42,\n        columnNumber: 26\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 41,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 39,\n    columnNumber: 5\n  }, this);\n};\n_c = SwapInput;\nconst ChangeDirectionButton = _ref2 => {\n  let {\n    onClick,\n    disabled\n  } = _ref2;\n  return /*#__PURE__*/_jsxDEV(\"button\", {\n    className: \"ChangeDirectionBtn\",\n    onClick: onClick,\n    disabled: disabled,\n    children: \"\\uD83D\\uDD04\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 50,\n    columnNumber: 5\n  }, this);\n};\n_c2 = ChangeDirectionButton;\nconst SlippageControl = _ref3 => {\n  let {\n    setSlippage,\n    slippage\n  } = _ref3;\n  return /*#__PURE__*/_jsxDEV(\"fieldset\", {\n    className: \"SlippageControl\",\n    children: [/*#__PURE__*/_jsxDEV(\"label\", {\n      htmlFor: \"slippage\",\n      children: \"Slippage tolerance, %\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"text\",\n      value: slippage,\n      onChange: ev => setSlippage(ev.target.value)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 56,\n    columnNumber: 5\n  }, this);\n};\n_c3 = SlippageControl;\nconst SwapForm = _ref4 => {\n  _s();\n  let {\n    setPairs\n  } = _ref4;\n  const metamaskContext = useContext(MetaMaskContext);\n  const enabled = metamaskContext.status === 'connected';\n  const account = metamaskContext.account;\n  const [zeroForOne, setZeroForOne] = useState(true);\n  const [amount0, setAmount0] = useState(0);\n  const [amount1, setAmount1] = useState(0);\n  const [tokenIn, setTokenIn] = useState();\n  const [manager, setManager] = useState();\n  const [quoter, setQuoter] = useState();\n  const [loading, setLoading] = useState(false);\n  const [addingLiquidity, setAddingLiquidity] = useState(false);\n  const [removingLiquidity, setRemovingLiquidity] = useState(false);\n  const [slippage, setSlippage] = useState(0.1);\n  const [tokens, setTokens] = useState();\n  const [path, setPath] = useState();\n  const [pathFinder, setPathFinder] = useState();\n  useEffect(() => {\n    setManager(new ethers.Contract(config.managerAddress, config.ABIs.Manager, new ethers.providers.Web3Provider(window.ethereum).getSigner()));\n    setQuoter(new ethers.Contract(config.quoterAddress, config.ABIs.Quoter, new ethers.providers.Web3Provider(window.ethereum).getSigner()));\n    setTokenIn(new ethers.Contract(config.wethAddress, config.ABIs.ERC20, new ethers.providers.Web3Provider(window.ethereum).getSigner()));\n    loadPairs().then(pairs => {\n      const pair_ = pairs.filter(pair => {\n        return pair.token0.address === config.wethAddress || pair.token1.address === config.wethAddress;\n      })[0];\n      const path_ = [config.wethAddress, pair_.fee, pair_.token0.address === config.wethAddress ? pair_.token1.address : pair_.token0.address];\n      setPairs(pairs);\n      setPath(path_);\n      setPathFinder(new PathFinder(pairs));\n      setTokens(pairsToTokens(pairs));\n    });\n  }, [setPairs]);\n\n  /**\n   * Load pairs from a Factory address by scanning for 'PoolCreated' events.\n   * \n   * @returns array of 'pair' objects.\n   */\n  const loadPairs = () => {\n    const factory = new ethers.Contract(config.factoryAddress, config.ABIs.Factory, new ethers.providers.Web3Provider(window.ethereum).getSigner());\n    return factory.queryFilter(\"PoolCreated\", \"earliest\", \"latest\").then(events => {\n      const pairs = events.map(event => {\n        return {\n          token0: {\n            address: event.args.token0,\n            symbol: config.tokens[event.args.token0].symbol\n          },\n          token1: {\n            address: event.args.token1,\n            symbol: config.tokens[event.args.token1].symbol\n          },\n          fee: event.args.fee,\n          address: event.args.pool\n        };\n      });\n      return Promise.resolve(pairs);\n    }).catch(err => {\n      console.error(err);\n    });\n  };\n\n  /**\n   * Swaps tokens by calling Manager contract. Before swapping, asks users to approve spending of tokens.\n   */\n  const swap = e => {\n    e.preventDefault();\n    const amountIn = ethers.utils.parseEther(zeroForOne ? amount0 : amount1);\n    const amountOut = ethers.utils.parseEther(zeroForOne ? amount1 : amount0);\n    const minAmountOut = amountOut.mul((100 - parseFloat(slippage)) * 100).div(10000);\n    const packedPath = ethers.utils.solidityPack(pathToTypes(path), path);\n    const params = {\n      path: packedPath,\n      recipient: account,\n      amountIn: amountIn,\n      minAmountOut: minAmountOut\n    };\n    const token = tokenIn.attach(path[0]);\n    token.allowance(account, config.managerAddress).then(allowance => {\n      if (allowance.lt(amountIn)) {\n        return token.approve(config.managerAddress, uint256Max).then(tx => tx.wait());\n      }\n    }).then(() => {\n      return manager.swap(params).then(tx => tx.wait());\n    }).then(() => {\n      alert('Swap succeeded!');\n    }).catch(err => {\n      console.error(err);\n      alert('Failed!');\n    });\n  };\n\n  /**\n   * Calculates output amount by querying Quoter contract. Sets 'priceAfter' and 'amountOut'.\n   */\n  const updateAmountOut = debounce(amount => {\n    if (amount === 0 || amount === \"0\") {\n      return;\n    }\n    setLoading(true);\n    const packedPath = ethers.utils.solidityPack(pathToTypes(path), path);\n    const amountIn = ethers.utils.parseEther(amount);\n    quoter.callStatic.quote(packedPath, amountIn).then(_ref5 => {\n      let {\n        amountOut\n      } = _ref5;\n      zeroForOne ? setAmount1(ethers.utils.formatEther(amountOut)) : setAmount0(ethers.utils.formatEther(amountOut));\n      setLoading(false);\n    }).catch(err => {\n      zeroForOne ? setAmount1(0) : setAmount0(0);\n      setLoading(false);\n      console.error(err);\n    });\n  });\n\n  /**\n   *  Wraps 'setAmount', ensures amount is correct, and calls 'updateAmountOut'.\n   */\n  const setAmountFn = setAmountFn => {\n    return amount => {\n      amount = amount || 0;\n      setAmountFn(amount);\n      updateAmountOut(amount);\n    };\n  };\n  const toggleAddLiquidityForm = () => {\n    if (!addingLiquidity) {\n      if (path.length > 3) {\n        const token0 = tokens.filter(t => t.address === path[0])[0];\n        const token1 = tokens.filter(t => t.address === path[path.length - 1])[0];\n        alert(`Cannot add liquidity: ${token0.symbol}/${token1.symbol} pair doesn't exist!`);\n        return false;\n      }\n    }\n    setAddingLiquidity(!addingLiquidity);\n  };\n  const toggleRemoveLiquidityForm = () => {\n    if (!removingLiquidity) {\n      if (path.length > 3) {\n        const token0 = tokens.filter(t => t.address === path[0])[0];\n        const token1 = tokens.filter(t => t.address === path[path.length - 1])[0];\n        alert(`Cannot add liquidity: ${token0.symbol}/${token1.symbol} pair doesn't exist!`);\n        return false;\n      }\n    }\n    setRemovingLiquidity(!removingLiquidity);\n  };\n\n  /**\n   * Set currently selected pair based on selected tokens.\n   * \n   * @param {symbol} selected token symbol\n   * @param {index} token index\n   */\n  const selectToken = (symbol, index) => {\n    let token0, token1;\n    if (index === 0) {\n      token0 = tokens.filter(t => t.symbol === symbol)[0].address;\n      token1 = path[path.length - 1];\n    }\n    if (index === 1) {\n      token0 = path[0];\n      token1 = tokens.filter(t => t.symbol === symbol)[0].address;\n    }\n    if (token0 === token1) {\n      return false;\n    }\n    try {\n      setPath(pathFinder.findPath(token0, token1));\n      setAmount0(0);\n      setAmount1(0);\n    } catch {\n      alert(`${token0.symbol}/${token1.symbol} pair doesn't exist!`);\n    }\n  };\n\n  /**\n   * Toggles swap direction.\n   */\n  const toggleDirection = e => {\n    e.preventDefault();\n    setZeroForOne(!zeroForOne);\n    setPath(path.reverse());\n  };\n  const tokenByAddress = address => {\n    return tokens.filter(t => t.address === address)[0];\n  };\n  return /*#__PURE__*/_jsxDEV(\"section\", {\n    className: \"SwapContainer\",\n    children: [addingLiquidity && /*#__PURE__*/_jsxDEV(AddLiquidityForm, {\n      toggle: toggleAddLiquidityForm,\n      token0Info: tokens.filter(t => t.address === path[0])[0],\n      token1Info: tokens.filter(t => t.address === path[2])[0],\n      fee: path[1]\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 300,\n      columnNumber: 9\n    }, this), removingLiquidity && /*#__PURE__*/_jsxDEV(RemoveLiquidityForm, {\n      toggle: toggleRemoveLiquidityForm,\n      token0Info: tokens.filter(t => t.address === path[0])[0],\n      token1Info: tokens.filter(t => t.address === path[2])[0],\n      fee: path[1]\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 306,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"header\", {\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: \"Swap tokens\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 312,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        disabled: !enabled || loading,\n        onClick: toggleAddLiquidityForm,\n        children: \"Add liquidity\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 313,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        disabled: !enabled || loading,\n        onClick: toggleRemoveLiquidityForm,\n        children: \"Remove liquidity\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 314,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 311,\n      columnNumber: 7\n    }, this), path ? /*#__PURE__*/_jsxDEV(\"form\", {\n      className: \"SwapForm\",\n      children: [/*#__PURE__*/_jsxDEV(SwapInput, {\n        amount: zeroForOne ? amount0 : amount1,\n        disabled: !enabled || loading,\n        onChange: ev => selectToken(ev.target.value, 0),\n        readOnly: false,\n        setAmount: setAmountFn(zeroForOne ? setAmount0 : setAmount1),\n        token: tokenByAddress(path[0]).symbol,\n        tokens: tokens\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 318,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(ChangeDirectionButton, {\n        zeroForOne: zeroForOne,\n        onClick: toggleDirection,\n        disabled: !enabled || loading\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 326,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(SwapInput, {\n        amount: zeroForOne ? amount1 : amount0,\n        disabled: !enabled || loading,\n        onChange: ev => selectToken(ev.target.value, 1),\n        readOnly: true,\n        token: tokenByAddress(path[path.length - 1]).symbol,\n        tokens: tokens.filter(t => t.address !== path[0])\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 327,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(SlippageControl, {\n        setSlippage: setSlippage,\n        slippage: slippage\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 334,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"swap\",\n        disabled: !enabled || loading,\n        onClick: swap,\n        children: \"Swap\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 337,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 317,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"span\", {\n      children: \"Loading pairs...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 340,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 298,\n    columnNumber: 5\n  }, this);\n};\n_s(SwapForm, \"JoSzilbHuChAu9VExRQMTk4V2o0=\");\n_c4 = SwapForm;\nexport default SwapForm;\nvar _c, _c2, _c3, _c4;\n$RefreshReg$(_c, \"SwapInput\");\n$RefreshReg$(_c2, \"ChangeDirectionButton\");\n$RefreshReg$(_c3, \"SlippageControl\");\n$RefreshReg$(_c4, \"SwapForm\");","map":{"version":3,"names":["ethers","useContext","useEffect","useState","uint256Max","MetaMaskContext","config","debounce","AddLiquidityForm","RemoveLiquidityForm","PathFinder","jsxDEV","_jsxDEV","pairsToTokens","pairs","tokens","reduce","acc","pair","token0","address","symbol","selected","token1","Object","keys","map","k","countPathTokens","path","length","pathToTypes","concat","Array","fill","flat","SwapInput","_ref","token","onChange","amount","setAmount","disabled","readOnly","className","children","type","id","placeholder","value","ev","target","fileName","_jsxFileName","lineNumber","columnNumber","name","t","_c","ChangeDirectionButton","_ref2","onClick","_c2","SlippageControl","_ref3","setSlippage","slippage","htmlFor","_c3","SwapForm","_ref4","_s","setPairs","metamaskContext","enabled","status","account","zeroForOne","setZeroForOne","amount0","setAmount0","amount1","setAmount1","tokenIn","setTokenIn","manager","setManager","quoter","setQuoter","loading","setLoading","addingLiquidity","setAddingLiquidity","removingLiquidity","setRemovingLiquidity","setTokens","setPath","pathFinder","setPathFinder","Contract","managerAddress","ABIs","Manager","providers","Web3Provider","window","ethereum","getSigner","quoterAddress","Quoter","wethAddress","ERC20","loadPairs","then","pair_","filter","path_","fee","factory","factoryAddress","Factory","queryFilter","events","event","args","pool","Promise","resolve","catch","err","console","error","swap","e","preventDefault","amountIn","utils","parseEther","amountOut","minAmountOut","mul","parseFloat","div","packedPath","solidityPack","params","recipient","attach","allowance","lt","approve","tx","wait","alert","updateAmountOut","callStatic","quote","_ref5","formatEther","setAmountFn","toggleAddLiquidityForm","toggleRemoveLiquidityForm","selectToken","index","findPath","toggleDirection","reverse","tokenByAddress","toggle","token0Info","token1Info","_c4","$RefreshReg$"],"sources":["/home/brandon/security/learning/defi/uniswapv3-src/uniswapv3-code/ui/src/components/SwapForm.js"],"sourcesContent":["import './SwapForm.css';\nimport { ethers } from 'ethers';\nimport { useContext, useEffect, useState } from 'react';\nimport { uint256Max } from '../lib/constants';\nimport { MetaMaskContext } from '../contexts/MetaMask';\nimport config from \"../config.js\";\nimport debounce from '../lib/debounce';\nimport AddLiquidityForm from './AddLiquidityForm';\nimport RemoveLiquidityForm from './RemoveLiquidityForm';\nimport PathFinder from '../lib/pathFinder';\n\nconst pairsToTokens = (pairs) => {\n  const tokens = pairs.reduce((acc, pair) => {\n    acc[pair.token0.address] = {\n      symbol: pair.token0.symbol,\n      address: pair.token0.address,\n      selected: false\n    };\n    acc[pair.token1.address] = {\n      symbol: pair.token1.symbol,\n      address: pair.token1.address,\n      selected: false\n    };\n\n    return acc;\n  }, {});\n\n  return Object.keys(tokens).map(k => tokens[k]);\n}\n\nconst countPathTokens = (path) => (path.length - 1) / 2 + 1;\n\nconst pathToTypes = (path) => {\n  return [\"address\"].concat(new Array(countPathTokens(path) - 1).fill([\"uint24\", \"address\"]).flat());\n}\n\nconst SwapInput = ({ token, tokens, onChange, amount, setAmount, disabled, readOnly }) => {\n  return (\n    <fieldset className=\"SwapInput\" disabled={disabled}>\n      <input type=\"text\" id={token + \"_amount\"} placeholder=\"0.0\" value={amount} onChange={(ev) => setAmount(ev.target.value)} readOnly={readOnly} />\n      <select name=\"token\" value={token} onChange={onChange}>\n        {tokens.map(t => <option key={`${token}_${t.symbol}`}>{t.symbol}</option>)}\n      </select>\n    </fieldset>\n  );\n}\n\nconst ChangeDirectionButton = ({ onClick, disabled }) => {\n  return (\n    <button className='ChangeDirectionBtn' onClick={onClick} disabled={disabled}>🔄</button>\n  )\n}\n\nconst SlippageControl = ({ setSlippage, slippage }) => {\n  return (\n    <fieldset className=\"SlippageControl\">\n      <label htmlFor=\"slippage\">Slippage tolerance, %</label>\n      <input type=\"text\" value={slippage} onChange={(ev) => setSlippage(ev.target.value)} />\n    </fieldset>\n  );\n}\n\nconst SwapForm = ({ setPairs }) => {\n  const metamaskContext = useContext(MetaMaskContext);\n  const enabled = metamaskContext.status === 'connected';\n  const account = metamaskContext.account;\n\n  const [zeroForOne, setZeroForOne] = useState(true);\n  const [amount0, setAmount0] = useState(0);\n  const [amount1, setAmount1] = useState(0);\n  const [tokenIn, setTokenIn] = useState();\n  const [manager, setManager] = useState();\n  const [quoter, setQuoter] = useState();\n  const [loading, setLoading] = useState(false);\n  const [addingLiquidity, setAddingLiquidity] = useState(false);\n  const [removingLiquidity, setRemovingLiquidity] = useState(false);\n  const [slippage, setSlippage] = useState(0.1);\n  const [tokens, setTokens] = useState();\n  const [path, setPath] = useState();\n  const [pathFinder, setPathFinder] = useState();\n\n  useEffect(() => {\n    setManager(new ethers.Contract(\n      config.managerAddress,\n      config.ABIs.Manager,\n      new ethers.providers.Web3Provider(window.ethereum).getSigner()\n    ));\n    setQuoter(new ethers.Contract(\n      config.quoterAddress,\n      config.ABIs.Quoter,\n      new ethers.providers.Web3Provider(window.ethereum).getSigner()\n    ));\n\n    setTokenIn(new ethers.Contract(\n      config.wethAddress,\n      config.ABIs.ERC20,\n      new ethers.providers.Web3Provider(window.ethereum).getSigner()\n    ));\n\n    loadPairs().then((pairs) => {\n      const pair_ = pairs.filter((pair) => {\n        return pair.token0.address === config.wethAddress || pair.token1.address === config.wethAddress;\n      })[0];\n      const path_ = [\n        config.wethAddress,\n        pair_.fee,\n        pair_.token0.address === config.wethAddress ? pair_.token1.address : pair_.token0.address\n      ];\n\n      setPairs(pairs);\n      setPath(path_);\n      setPathFinder(new PathFinder(pairs));\n      setTokens(pairsToTokens(pairs));\n    });\n  }, [setPairs]);\n\n  /**\n   * Load pairs from a Factory address by scanning for 'PoolCreated' events.\n   * \n   * @returns array of 'pair' objects.\n   */\n  const loadPairs = () => {\n    const factory = new ethers.Contract(\n      config.factoryAddress,\n      config.ABIs.Factory,\n      new ethers.providers.Web3Provider(window.ethereum).getSigner()\n    );\n\n    return factory.queryFilter(\"PoolCreated\", \"earliest\", \"latest\")\n      .then((events) => {\n        const pairs = events.map((event) => {\n          return {\n            token0: {\n              address: event.args.token0,\n              symbol: config.tokens[event.args.token0].symbol\n            },\n            token1: {\n              address: event.args.token1,\n              symbol: config.tokens[event.args.token1].symbol\n            },\n            fee: event.args.fee,\n            address: event.args.pool\n          }\n        });\n\n        return Promise.resolve(pairs);\n      }).catch((err) => {\n        console.error(err)\n      });\n  }\n\n\n  /**\n   * Swaps tokens by calling Manager contract. Before swapping, asks users to approve spending of tokens.\n   */\n  const swap = (e) => {\n    e.preventDefault();\n\n    const amountIn = ethers.utils.parseEther(zeroForOne ? amount0 : amount1);\n    const amountOut = ethers.utils.parseEther(zeroForOne ? amount1 : amount0);\n    const minAmountOut = amountOut.mul((100 - parseFloat(slippage)) * 100).div(10000);\n    const packedPath = ethers.utils.solidityPack(pathToTypes(path), path);\n    const params = {\n      path: packedPath,\n      recipient: account,\n      amountIn: amountIn,\n      minAmountOut: minAmountOut\n    };\n    const token = tokenIn.attach(path[0]);\n\n    token.allowance(account, config.managerAddress)\n      .then((allowance) => {\n        if (allowance.lt(amountIn)) {\n          return token.approve(config.managerAddress, uint256Max).then(tx => tx.wait())\n        }\n      })\n      .then(() => {\n        return manager.swap(params).then(tx => tx.wait())\n      })\n      .then(() => {\n        alert('Swap succeeded!');\n      }).catch((err) => {\n        console.error(err);\n        alert('Failed!');\n      });\n  }\n\n  /**\n   * Calculates output amount by querying Quoter contract. Sets 'priceAfter' and 'amountOut'.\n   */\n  const updateAmountOut = debounce((amount) => {\n    if (amount === 0 || amount === \"0\") {\n      return;\n    }\n\n    setLoading(true);\n\n    const packedPath = ethers.utils.solidityPack(pathToTypes(path), path);\n    const amountIn = ethers.utils.parseEther(amount);\n\n    quoter.callStatic\n      .quote(packedPath, amountIn)\n      .then(({ amountOut }) => {\n        zeroForOne ? setAmount1(ethers.utils.formatEther(amountOut)) : setAmount0(ethers.utils.formatEther(amountOut));\n        setLoading(false);\n      })\n      .catch((err) => {\n        zeroForOne ? setAmount1(0) : setAmount0(0);\n        setLoading(false);\n        console.error(err);\n      })\n  })\n\n  /**\n   *  Wraps 'setAmount', ensures amount is correct, and calls 'updateAmountOut'.\n   */\n  const setAmountFn = (setAmountFn) => {\n    return (amount) => {\n      amount = amount || 0;\n      setAmountFn(amount);\n      updateAmountOut(amount)\n    }\n  }\n\n  const toggleAddLiquidityForm = () => {\n    if (!addingLiquidity) {\n      if (path.length > 3) {\n        const token0 = tokens.filter(t => t.address === path[0])[0];\n        const token1 = tokens.filter(t => t.address === path[path.length - 1])[0];\n        alert(`Cannot add liquidity: ${token0.symbol}/${token1.symbol} pair doesn't exist!`);\n        return false;\n      }\n    }\n\n    setAddingLiquidity(!addingLiquidity);\n  }\n\n  const toggleRemoveLiquidityForm = () => {\n    if (!removingLiquidity) {\n      if (path.length > 3) {\n        const token0 = tokens.filter(t => t.address === path[0])[0];\n        const token1 = tokens.filter(t => t.address === path[path.length - 1])[0];\n        alert(`Cannot add liquidity: ${token0.symbol}/${token1.symbol} pair doesn't exist!`);\n        return false;\n      }\n    }\n\n    setRemovingLiquidity(!removingLiquidity);\n  }\n\n  /**\n   * Set currently selected pair based on selected tokens.\n   * \n   * @param {symbol} selected token symbol\n   * @param {index} token index\n   */\n  const selectToken = (symbol, index) => {\n    let token0, token1;\n\n    if (index === 0) {\n      token0 = tokens.filter(t => t.symbol === symbol)[0].address;\n      token1 = path[path.length - 1];\n    }\n\n    if (index === 1) {\n      token0 = path[0];\n      token1 = tokens.filter(t => t.symbol === symbol)[0].address;\n    }\n\n    if (token0 === token1) {\n      return false;\n    }\n\n    try {\n      setPath(pathFinder.findPath(token0, token1));\n      setAmount0(0);\n      setAmount1(0);\n    } catch {\n      alert(`${token0.symbol}/${token1.symbol} pair doesn't exist!`);\n    }\n  }\n\n  /**\n   * Toggles swap direction.\n   */\n  const toggleDirection = (e) => {\n    e.preventDefault();\n\n    setZeroForOne(!zeroForOne);\n    setPath(path.reverse());\n  }\n\n  const tokenByAddress = (address) => {\n    return tokens.filter(t => t.address === address)[0];\n  }\n\n  return (\n    <section className=\"SwapContainer\">\n      {addingLiquidity &&\n        <AddLiquidityForm\n          toggle={toggleAddLiquidityForm}\n          token0Info={tokens.filter(t => t.address === path[0])[0]}\n          token1Info={tokens.filter(t => t.address === path[2])[0]}\n          fee={path[1]} />}\n      {removingLiquidity &&\n        <RemoveLiquidityForm\n          toggle={toggleRemoveLiquidityForm}\n          token0Info={tokens.filter(t => t.address === path[0])[0]}\n          token1Info={tokens.filter(t => t.address === path[2])[0]}\n          fee={path[1]} />}\n      <header>\n        <h1>Swap tokens</h1>\n        <button disabled={!enabled || loading} onClick={toggleAddLiquidityForm}>Add liquidity</button>\n        <button disabled={!enabled || loading} onClick={toggleRemoveLiquidityForm}>Remove liquidity</button>\n      </header>\n      {path ?\n        <form className=\"SwapForm\">\n          <SwapInput\n            amount={zeroForOne ? amount0 : amount1}\n            disabled={!enabled || loading}\n            onChange={(ev) => selectToken(ev.target.value, 0)}\n            readOnly={false}\n            setAmount={setAmountFn(zeroForOne ? setAmount0 : setAmount1)}\n            token={tokenByAddress(path[0]).symbol}\n            tokens={tokens} />\n          <ChangeDirectionButton zeroForOne={zeroForOne} onClick={toggleDirection} disabled={!enabled || loading} />\n          <SwapInput\n            amount={zeroForOne ? amount1 : amount0}\n            disabled={!enabled || loading}\n            onChange={(ev) => selectToken(ev.target.value, 1)}\n            readOnly={true}\n            token={tokenByAddress(path[path.length - 1]).symbol}\n            tokens={tokens.filter(t => t.address !== path[0])} />\n          <SlippageControl\n            setSlippage={setSlippage}\n            slippage={slippage} />\n          <button className='swap' disabled={!enabled || loading} onClick={swap}>Swap</button>\n        </form>\n        :\n        <span>Loading pairs...</span>}\n    </section>\n  )\n}\n\nexport default SwapForm;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}