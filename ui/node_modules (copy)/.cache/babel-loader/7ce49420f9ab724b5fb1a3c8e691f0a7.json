{"ast":null,"code":"import _slicedToArray from \"/home/brandon/security/learning/defi/uniswapv3-src/uniswapv3-code/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _this = this,\n  _jsxFileName = \"/home/brandon/security/learning/defi/uniswapv3-src/uniswapv3-code/ui/src/components/SwapForm.js\";\nimport './SwapForm.css';\nimport { ethers } from 'ethers';\nimport { useContext, useEffect, useState } from 'react';\nimport { uint256Max } from '../lib/constants';\nimport { MetaMaskContext } from '../contexts/MetaMask';\nimport config from \"../config.js\";\nimport debounce from '../lib/debounce';\nimport AddLiquidityForm from './AddLiquidityForm';\nimport RemoveLiquidityForm from './RemoveLiquidityForm';\nimport PathFinder from '../lib/pathFinder';\nvar pairsToTokens = function pairsToTokens(pairs) {\n  var tokens = pairs.reduce(function (acc, pair) {\n    acc[pair.token0.address] = {\n      symbol: pair.token0.symbol,\n      address: pair.token0.address,\n      selected: false\n    };\n    acc[pair.token1.address] = {\n      symbol: pair.token1.symbol,\n      address: pair.token1.address,\n      selected: false\n    };\n    return acc;\n  }, {});\n  return Object.keys(tokens).map(function (k) {\n    return tokens[k];\n  });\n};\nvar countPathTokens = function countPathTokens(path) {\n  return (path.length - 1) / 2 + 1;\n};\nvar pathToTypes = function pathToTypes(path) {\n  return [\"address\"].concat(new Array(countPathTokens(path) - 1).fill([\"uint24\", \"address\"]).flat());\n};\nvar SwapInput = function SwapInput(_ref) {\n  var token = _ref.token,\n    tokens = _ref.tokens,\n    onChange = _ref.onChange,\n    amount = _ref.amount,\n    setAmount = _ref.setAmount,\n    disabled = _ref.disabled,\n    readOnly = _ref.readOnly;\n  return /*#__PURE__*/React.createElement(\"fieldset\", {\n    className: \"SwapInput\",\n    disabled: disabled,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 39,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    id: token + \"_amount\",\n    placeholder: \"0.0\",\n    value: amount,\n    onChange: function onChange(ev) {\n      return setAmount(ev.target.value);\n    },\n    readOnly: readOnly,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 40,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"select\", {\n    name: \"token\",\n    value: token,\n    onChange: onChange,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 41,\n      columnNumber: 7\n    }\n  }, tokens.map(function (t) {\n    return /*#__PURE__*/React.createElement(\"option\", {\n      key: \"\".concat(token, \"_\").concat(t.symbol),\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 42,\n        columnNumber: 26\n      }\n    }, t.symbol);\n  })));\n};\nvar ChangeDirectionButton = function ChangeDirectionButton(_ref2) {\n  var onClick = _ref2.onClick,\n    disabled = _ref2.disabled;\n  return /*#__PURE__*/React.createElement(\"button\", {\n    className: \"ChangeDirectionBtn\",\n    onClick: onClick,\n    disabled: disabled,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 50,\n      columnNumber: 5\n    }\n  }, \"\\uD83D\\uDD04\");\n};\nvar SlippageControl = function SlippageControl(_ref3) {\n  var setSlippage = _ref3.setSlippage,\n    slippage = _ref3.slippage;\n  return /*#__PURE__*/React.createElement(\"fieldset\", {\n    className: \"SlippageControl\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: \"slippage\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 7\n    }\n  }, \"Slippage tolerance, %\"), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    value: slippage,\n    onChange: function onChange(ev) {\n      return setSlippage(ev.target.value);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 7\n    }\n  }));\n};\nvar SwapForm = function SwapForm(_ref4) {\n  var setPairs = _ref4.setPairs;\n  var metamaskContext = useContext(MetaMaskContext);\n  var enabled = metamaskContext.status === 'connected';\n  var account = metamaskContext.account;\n  var _useState = useState(true),\n    _useState2 = _slicedToArray(_useState, 2),\n    zeroForOne = _useState2[0],\n    setZeroForOne = _useState2[1];\n  var _useState3 = useState(0),\n    _useState4 = _slicedToArray(_useState3, 2),\n    amount0 = _useState4[0],\n    setAmount0 = _useState4[1];\n  var _useState5 = useState(0),\n    _useState6 = _slicedToArray(_useState5, 2),\n    amount1 = _useState6[0],\n    setAmount1 = _useState6[1];\n  var _useState7 = useState(),\n    _useState8 = _slicedToArray(_useState7, 2),\n    tokenIn = _useState8[0],\n    setTokenIn = _useState8[1];\n  var _useState9 = useState(),\n    _useState10 = _slicedToArray(_useState9, 2),\n    manager = _useState10[0],\n    setManager = _useState10[1];\n  var _useState11 = useState(),\n    _useState12 = _slicedToArray(_useState11, 2),\n    quoter = _useState12[0],\n    setQuoter = _useState12[1];\n  var _useState13 = useState(false),\n    _useState14 = _slicedToArray(_useState13, 2),\n    loading = _useState14[0],\n    setLoading = _useState14[1];\n  var _useState15 = useState(false),\n    _useState16 = _slicedToArray(_useState15, 2),\n    addingLiquidity = _useState16[0],\n    setAddingLiquidity = _useState16[1];\n  var _useState17 = useState(false),\n    _useState18 = _slicedToArray(_useState17, 2),\n    removingLiquidity = _useState18[0],\n    setRemovingLiquidity = _useState18[1];\n  var _useState19 = useState(0.1),\n    _useState20 = _slicedToArray(_useState19, 2),\n    slippage = _useState20[0],\n    setSlippage = _useState20[1];\n  var _useState21 = useState(),\n    _useState22 = _slicedToArray(_useState21, 2),\n    tokens = _useState22[0],\n    setTokens = _useState22[1];\n  var _useState23 = useState(),\n    _useState24 = _slicedToArray(_useState23, 2),\n    path = _useState24[0],\n    setPath = _useState24[1];\n  var _useState25 = useState(),\n    _useState26 = _slicedToArray(_useState25, 2),\n    pathFinder = _useState26[0],\n    setPathFinder = _useState26[1];\n  useEffect(function () {\n    setManager(new ethers.Contract(config.managerAddress, config.ABIs.Manager, new ethers.providers.Web3Provider(window.ethereum).getSigner()));\n    setQuoter(new ethers.Contract(config.quoterAddress, config.ABIs.Quoter, new ethers.providers.Web3Provider(window.ethereum).getSigner()));\n    setTokenIn(new ethers.Contract(config.wethAddress, config.ABIs.ERC20, new ethers.providers.Web3Provider(window.ethereum).getSigner()));\n    loadPairs().then(function (pairs) {\n      var pair_ = pairs.filter(function (pair) {\n        return pair.token0.address === config.wethAddress || pair.token1.address === config.wethAddress;\n      })[0];\n      var path_ = [config.wethAddress, pair_.fee, pair_.token0.address === config.wethAddress ? pair_.token1.address : pair_.token0.address];\n      setPairs(pairs);\n      setPath(path_);\n      setPathFinder(new PathFinder(pairs));\n      setTokens(pairsToTokens(pairs));\n    });\n  }, [setPairs]);\n\n  /**\n   * Load pairs from a Factory address by scanning for 'PoolCreated' events.\n   * \n   * @returns array of 'pair' objects.\n   */\n  var loadPairs = function loadPairs() {\n    var factory = new ethers.Contract(config.factoryAddress, config.ABIs.Factory, new ethers.providers.Web3Provider(window.ethereum).getSigner());\n    return factory.queryFilter(\"PoolCreated\", \"earliest\", \"latest\").then(function (events) {\n      var pairs = events.map(function (event) {\n        return {\n          token0: {\n            address: event.args.token0,\n            symbol: config.tokens[event.args.token0].symbol\n          },\n          token1: {\n            address: event.args.token1,\n            symbol: config.tokens[event.args.token1].symbol\n          },\n          fee: event.args.fee,\n          address: event.args.pool\n        };\n      });\n      return Promise.resolve(pairs);\n    }).catch(function (err) {\n      console.error(err);\n    });\n  };\n\n  /**\n   * Swaps tokens by calling Manager contract. Before swapping, asks users to approve spending of tokens.\n   */\n  var swap = function swap(e) {\n    e.preventDefault();\n    var amountIn = ethers.utils.parseEther(zeroForOne ? amount0 : amount1);\n    var amountOut = ethers.utils.parseEther(zeroForOne ? amount1 : amount0);\n    var minAmountOut = amountOut.mul((100 - parseFloat(slippage)) * 100).div(10000);\n    var packedPath = ethers.utils.solidityPack(pathToTypes(path), path);\n    var params = {\n      path: packedPath,\n      recipient: account,\n      amountIn: amountIn,\n      minAmountOut: minAmountOut\n    };\n    var token = tokenIn.attach(path[0]);\n    token.allowance(account, config.managerAddress).then(function (allowance) {\n      if (allowance.lt(amountIn)) {\n        return token.approve(config.managerAddress, uint256Max).then(function (tx) {\n          return tx.wait();\n        });\n      }\n    }).then(function () {\n      return manager.swap(params).then(function (tx) {\n        return tx.wait();\n      });\n    }).then(function () {\n      alert('Swap succeeded!');\n    }).catch(function (err) {\n      console.error(err);\n      alert('Failed!');\n    });\n  };\n\n  /**\n   * Calculates output amount by querying Quoter contract. Sets 'priceAfter' and 'amountOut'.\n   */\n  var updateAmountOut = debounce(function (amount) {\n    if (amount === 0 || amount === \"0\") {\n      return;\n    }\n    setLoading(true);\n    var packedPath = ethers.utils.solidityPack(pathToTypes(path), path);\n    var amountIn = ethers.utils.parseEther(amount);\n    quoter.callStatic.quote(packedPath, amountIn).then(function (_ref5) {\n      var amountOut = _ref5.amountOut;\n      zeroForOne ? setAmount1(ethers.utils.formatEther(amountOut)) : setAmount0(ethers.utils.formatEther(amountOut));\n      setLoading(false);\n    }).catch(function (err) {\n      zeroForOne ? setAmount1(0) : setAmount0(0);\n      setLoading(false);\n      console.error(err);\n    });\n  });\n\n  /**\n   *  Wraps 'setAmount', ensures amount is correct, and calls 'updateAmountOut'.\n   */\n  var setAmountFn = function setAmountFn(_setAmountFn) {\n    return function (amount) {\n      amount = amount || 0;\n      _setAmountFn(amount);\n      updateAmountOut(amount);\n    };\n  };\n  var toggleAddLiquidityForm = function toggleAddLiquidityForm() {\n    if (!addingLiquidity) {\n      if (path.length > 3) {\n        var token0 = tokens.filter(function (t) {\n          return t.address === path[0];\n        })[0];\n        var token1 = tokens.filter(function (t) {\n          return t.address === path[path.length - 1];\n        })[0];\n        alert(\"Cannot add liquidity: \".concat(token0.symbol, \"/\").concat(token1.symbol, \" pair doesn't exist!\"));\n        return false;\n      }\n    }\n    setAddingLiquidity(!addingLiquidity);\n  };\n  var toggleRemoveLiquidityForm = function toggleRemoveLiquidityForm() {\n    if (!removingLiquidity) {\n      if (path.length > 3) {\n        var token0 = tokens.filter(function (t) {\n          return t.address === path[0];\n        })[0];\n        var token1 = tokens.filter(function (t) {\n          return t.address === path[path.length - 1];\n        })[0];\n        alert(\"Cannot add liquidity: \".concat(token0.symbol, \"/\").concat(token1.symbol, \" pair doesn't exist!\"));\n        return false;\n      }\n    }\n    setRemovingLiquidity(!removingLiquidity);\n  };\n\n  /**\n   * Set currently selected pair based on selected tokens.\n   * \n   * @param {symbol} selected token symbol\n   * @param {index} token index\n   */\n  var selectToken = function selectToken(symbol, index) {\n    var token0, token1;\n    if (index === 0) {\n      token0 = tokens.filter(function (t) {\n        return t.symbol === symbol;\n      })[0].address;\n      token1 = path[path.length - 1];\n    }\n    if (index === 1) {\n      token0 = path[0];\n      token1 = tokens.filter(function (t) {\n        return t.symbol === symbol;\n      })[0].address;\n    }\n    if (token0 === token1) {\n      return false;\n    }\n    try {\n      setPath(pathFinder.findPath(token0, token1));\n      setAmount0(0);\n      setAmount1(0);\n    } catch (_unused) {\n      alert(\"\".concat(token0.symbol, \"/\").concat(token1.symbol, \" pair doesn't exist!\"));\n    }\n  };\n\n  /**\n   * Toggles swap direction.\n   */\n  var toggleDirection = function toggleDirection(e) {\n    e.preventDefault();\n    setZeroForOne(!zeroForOne);\n    setPath(path.reverse());\n  };\n  var tokenByAddress = function tokenByAddress(address) {\n    return tokens.filter(function (t) {\n      return t.address === address;\n    })[0];\n  };\n  return /*#__PURE__*/React.createElement(\"section\", {\n    className: \"SwapContainer\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 298,\n      columnNumber: 5\n    }\n  }, addingLiquidity && /*#__PURE__*/React.createElement(AddLiquidityForm, {\n    toggle: toggleAddLiquidityForm,\n    token0Info: tokens.filter(function (t) {\n      return t.address === path[0];\n    })[0],\n    token1Info: tokens.filter(function (t) {\n      return t.address === path[2];\n    })[0],\n    fee: path[1],\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 300,\n      columnNumber: 9\n    }\n  }), removingLiquidity && /*#__PURE__*/React.createElement(RemoveLiquidityForm, {\n    toggle: toggleRemoveLiquidityForm,\n    token0Info: tokens.filter(function (t) {\n      return t.address === path[0];\n    })[0],\n    token1Info: tokens.filter(function (t) {\n      return t.address === path[2];\n    })[0],\n    fee: path[1],\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 306,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"header\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 311,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"h1\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 312,\n      columnNumber: 9\n    }\n  }, \"Swap tokens\"), /*#__PURE__*/React.createElement(\"button\", {\n    disabled: !enabled || loading,\n    onClick: toggleAddLiquidityForm,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 313,\n      columnNumber: 9\n    }\n  }, \"Add liquidity\"), /*#__PURE__*/React.createElement(\"button\", {\n    disabled: !enabled || loading,\n    onClick: toggleRemoveLiquidityForm,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 314,\n      columnNumber: 9\n    }\n  }, \"Remove liquidity\")), path ? /*#__PURE__*/React.createElement(\"form\", {\n    className: \"SwapForm\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 317,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(SwapInput, {\n    amount: zeroForOne ? amount0 : amount1,\n    disabled: !enabled || loading,\n    onChange: function onChange(ev) {\n      return selectToken(ev.target.value, 0);\n    },\n    readOnly: false,\n    setAmount: setAmountFn(zeroForOne ? setAmount0 : setAmount1),\n    token: tokenByAddress(path[0]).symbol,\n    tokens: tokens,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 318,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(ChangeDirectionButton, {\n    zeroForOne: zeroForOne,\n    onClick: toggleDirection,\n    disabled: !enabled || loading,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 326,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(SwapInput, {\n    amount: zeroForOne ? amount1 : amount0,\n    disabled: !enabled || loading,\n    onChange: function onChange(ev) {\n      return selectToken(ev.target.value, 1);\n    },\n    readOnly: true,\n    token: tokenByAddress(path[path.length - 1]).symbol,\n    tokens: tokens.filter(function (t) {\n      return t.address !== path[0];\n    }),\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 327,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(SlippageControl, {\n    setSlippage: setSlippage,\n    slippage: slippage,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 334,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(\"button\", {\n    className: \"swap\",\n    disabled: !enabled || loading,\n    onClick: swap,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 337,\n      columnNumber: 11\n    }\n  }, \"Swap\")) : /*#__PURE__*/React.createElement(\"span\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 340,\n      columnNumber: 9\n    }\n  }, \"Loading pairs...\"));\n};\nexport default SwapForm;","map":{"version":3,"names":["ethers","useContext","useEffect","useState","uint256Max","MetaMaskContext","config","debounce","AddLiquidityForm","RemoveLiquidityForm","PathFinder","pairsToTokens","pairs","tokens","reduce","acc","pair","token0","address","symbol","selected","token1","Object","keys","map","k","countPathTokens","path","length","pathToTypes","concat","Array","fill","flat","SwapInput","_ref","token","onChange","amount","setAmount","disabled","readOnly","React","createElement","className","__self","_this","__source","fileName","_jsxFileName","lineNumber","columnNumber","type","id","placeholder","value","ev","target","name","t","key","ChangeDirectionButton","_ref2","onClick","SlippageControl","_ref3","setSlippage","slippage","htmlFor","SwapForm","_ref4","setPairs","metamaskContext","enabled","status","account","_useState","_useState2","_slicedToArray","zeroForOne","setZeroForOne","_useState3","_useState4","amount0","setAmount0","_useState5","_useState6","amount1","setAmount1","_useState7","_useState8","tokenIn","setTokenIn","_useState9","_useState10","manager","setManager","_useState11","_useState12","quoter","setQuoter","_useState13","_useState14","loading","setLoading","_useState15","_useState16","addingLiquidity","setAddingLiquidity","_useState17","_useState18","removingLiquidity","setRemovingLiquidity","_useState19","_useState20","_useState21","_useState22","setTokens","_useState23","_useState24","setPath","_useState25","_useState26","pathFinder","setPathFinder","Contract","managerAddress","ABIs","Manager","providers","Web3Provider","window","ethereum","getSigner","quoterAddress","Quoter","wethAddress","ERC20","loadPairs","then","pair_","filter","path_","fee","factory","factoryAddress","Factory","queryFilter","events","event","args","pool","Promise","resolve","catch","err","console","error","swap","e","preventDefault","amountIn","utils","parseEther","amountOut","minAmountOut","mul","parseFloat","div","packedPath","solidityPack","params","recipient","attach","allowance","lt","approve","tx","wait","alert","updateAmountOut","callStatic","quote","_ref5","formatEther","setAmountFn","toggleAddLiquidityForm","toggleRemoveLiquidityForm","selectToken","index","findPath","_unused","toggleDirection","reverse","tokenByAddress","toggle","token0Info","token1Info"],"sources":["/home/brandon/security/learning/defi/uniswapv3-src/uniswapv3-code/ui/src/components/SwapForm.js"],"sourcesContent":["import './SwapForm.css';\nimport { ethers } from 'ethers';\nimport { useContext, useEffect, useState } from 'react';\nimport { uint256Max } from '../lib/constants';\nimport { MetaMaskContext } from '../contexts/MetaMask';\nimport config from \"../config.js\";\nimport debounce from '../lib/debounce';\nimport AddLiquidityForm from './AddLiquidityForm';\nimport RemoveLiquidityForm from './RemoveLiquidityForm';\nimport PathFinder from '../lib/pathFinder';\n\nconst pairsToTokens = (pairs) => {\n  const tokens = pairs.reduce((acc, pair) => {\n    acc[pair.token0.address] = {\n      symbol: pair.token0.symbol,\n      address: pair.token0.address,\n      selected: false\n    };\n    acc[pair.token1.address] = {\n      symbol: pair.token1.symbol,\n      address: pair.token1.address,\n      selected: false\n    };\n\n    return acc;\n  }, {});\n\n  return Object.keys(tokens).map(k => tokens[k]);\n}\n\nconst countPathTokens = (path) => (path.length - 1) / 2 + 1;\n\nconst pathToTypes = (path) => {\n  return [\"address\"].concat(new Array(countPathTokens(path) - 1).fill([\"uint24\", \"address\"]).flat());\n}\n\nconst SwapInput = ({ token, tokens, onChange, amount, setAmount, disabled, readOnly }) => {\n  return (\n    <fieldset className=\"SwapInput\" disabled={disabled}>\n      <input type=\"text\" id={token + \"_amount\"} placeholder=\"0.0\" value={amount} onChange={(ev) => setAmount(ev.target.value)} readOnly={readOnly} />\n      <select name=\"token\" value={token} onChange={onChange}>\n        {tokens.map(t => <option key={`${token}_${t.symbol}`}>{t.symbol}</option>)}\n      </select>\n    </fieldset>\n  );\n}\n\nconst ChangeDirectionButton = ({ onClick, disabled }) => {\n  return (\n    <button className='ChangeDirectionBtn' onClick={onClick} disabled={disabled}>ðŸ”„</button>\n  )\n}\n\nconst SlippageControl = ({ setSlippage, slippage }) => {\n  return (\n    <fieldset className=\"SlippageControl\">\n      <label htmlFor=\"slippage\">Slippage tolerance, %</label>\n      <input type=\"text\" value={slippage} onChange={(ev) => setSlippage(ev.target.value)} />\n    </fieldset>\n  );\n}\n\nconst SwapForm = ({ setPairs }) => {\n  const metamaskContext = useContext(MetaMaskContext);\n  const enabled = metamaskContext.status === 'connected';\n  const account = metamaskContext.account;\n\n  const [zeroForOne, setZeroForOne] = useState(true);\n  const [amount0, setAmount0] = useState(0);\n  const [amount1, setAmount1] = useState(0);\n  const [tokenIn, setTokenIn] = useState();\n  const [manager, setManager] = useState();\n  const [quoter, setQuoter] = useState();\n  const [loading, setLoading] = useState(false);\n  const [addingLiquidity, setAddingLiquidity] = useState(false);\n  const [removingLiquidity, setRemovingLiquidity] = useState(false);\n  const [slippage, setSlippage] = useState(0.1);\n  const [tokens, setTokens] = useState();\n  const [path, setPath] = useState();\n  const [pathFinder, setPathFinder] = useState();\n\n  useEffect(() => {\n    setManager(new ethers.Contract(\n      config.managerAddress,\n      config.ABIs.Manager,\n      new ethers.providers.Web3Provider(window.ethereum).getSigner()\n    ));\n    setQuoter(new ethers.Contract(\n      config.quoterAddress,\n      config.ABIs.Quoter,\n      new ethers.providers.Web3Provider(window.ethereum).getSigner()\n    ));\n\n    setTokenIn(new ethers.Contract(\n      config.wethAddress,\n      config.ABIs.ERC20,\n      new ethers.providers.Web3Provider(window.ethereum).getSigner()\n    ));\n\n    loadPairs().then((pairs) => {\n      const pair_ = pairs.filter((pair) => {\n        return pair.token0.address === config.wethAddress || pair.token1.address === config.wethAddress;\n      })[0];\n      const path_ = [\n        config.wethAddress,\n        pair_.fee,\n        pair_.token0.address === config.wethAddress ? pair_.token1.address : pair_.token0.address\n      ];\n\n      setPairs(pairs);\n      setPath(path_);\n      setPathFinder(new PathFinder(pairs));\n      setTokens(pairsToTokens(pairs));\n    });\n  }, [setPairs]);\n\n  /**\n   * Load pairs from a Factory address by scanning for 'PoolCreated' events.\n   * \n   * @returns array of 'pair' objects.\n   */\n  const loadPairs = () => {\n    const factory = new ethers.Contract(\n      config.factoryAddress,\n      config.ABIs.Factory,\n      new ethers.providers.Web3Provider(window.ethereum).getSigner()\n    );\n\n    return factory.queryFilter(\"PoolCreated\", \"earliest\", \"latest\")\n      .then((events) => {\n        const pairs = events.map((event) => {\n          return {\n            token0: {\n              address: event.args.token0,\n              symbol: config.tokens[event.args.token0].symbol\n            },\n            token1: {\n              address: event.args.token1,\n              symbol: config.tokens[event.args.token1].symbol\n            },\n            fee: event.args.fee,\n            address: event.args.pool\n          }\n        });\n\n        return Promise.resolve(pairs);\n      }).catch((err) => {\n        console.error(err)\n      });\n  }\n\n\n  /**\n   * Swaps tokens by calling Manager contract. Before swapping, asks users to approve spending of tokens.\n   */\n  const swap = (e) => {\n    e.preventDefault();\n\n    const amountIn = ethers.utils.parseEther(zeroForOne ? amount0 : amount1);\n    const amountOut = ethers.utils.parseEther(zeroForOne ? amount1 : amount0);\n    const minAmountOut = amountOut.mul((100 - parseFloat(slippage)) * 100).div(10000);\n    const packedPath = ethers.utils.solidityPack(pathToTypes(path), path);\n    const params = {\n      path: packedPath,\n      recipient: account,\n      amountIn: amountIn,\n      minAmountOut: minAmountOut\n    };\n    const token = tokenIn.attach(path[0]);\n\n    token.allowance(account, config.managerAddress)\n      .then((allowance) => {\n        if (allowance.lt(amountIn)) {\n          return token.approve(config.managerAddress, uint256Max).then(tx => tx.wait())\n        }\n      })\n      .then(() => {\n        return manager.swap(params).then(tx => tx.wait())\n      })\n      .then(() => {\n        alert('Swap succeeded!');\n      }).catch((err) => {\n        console.error(err);\n        alert('Failed!');\n      });\n  }\n\n  /**\n   * Calculates output amount by querying Quoter contract. Sets 'priceAfter' and 'amountOut'.\n   */\n  const updateAmountOut = debounce((amount) => {\n    if (amount === 0 || amount === \"0\") {\n      return;\n    }\n\n    setLoading(true);\n\n    const packedPath = ethers.utils.solidityPack(pathToTypes(path), path);\n    const amountIn = ethers.utils.parseEther(amount);\n\n    quoter.callStatic\n      .quote(packedPath, amountIn)\n      .then(({ amountOut }) => {\n        zeroForOne ? setAmount1(ethers.utils.formatEther(amountOut)) : setAmount0(ethers.utils.formatEther(amountOut));\n        setLoading(false);\n      })\n      .catch((err) => {\n        zeroForOne ? setAmount1(0) : setAmount0(0);\n        setLoading(false);\n        console.error(err);\n      })\n  })\n\n  /**\n   *  Wraps 'setAmount', ensures amount is correct, and calls 'updateAmountOut'.\n   */\n  const setAmountFn = (setAmountFn) => {\n    return (amount) => {\n      amount = amount || 0;\n      setAmountFn(amount);\n      updateAmountOut(amount)\n    }\n  }\n\n  const toggleAddLiquidityForm = () => {\n    if (!addingLiquidity) {\n      if (path.length > 3) {\n        const token0 = tokens.filter(t => t.address === path[0])[0];\n        const token1 = tokens.filter(t => t.address === path[path.length - 1])[0];\n        alert(`Cannot add liquidity: ${token0.symbol}/${token1.symbol} pair doesn't exist!`);\n        return false;\n      }\n    }\n\n    setAddingLiquidity(!addingLiquidity);\n  }\n\n  const toggleRemoveLiquidityForm = () => {\n    if (!removingLiquidity) {\n      if (path.length > 3) {\n        const token0 = tokens.filter(t => t.address === path[0])[0];\n        const token1 = tokens.filter(t => t.address === path[path.length - 1])[0];\n        alert(`Cannot add liquidity: ${token0.symbol}/${token1.symbol} pair doesn't exist!`);\n        return false;\n      }\n    }\n\n    setRemovingLiquidity(!removingLiquidity);\n  }\n\n  /**\n   * Set currently selected pair based on selected tokens.\n   * \n   * @param {symbol} selected token symbol\n   * @param {index} token index\n   */\n  const selectToken = (symbol, index) => {\n    let token0, token1;\n\n    if (index === 0) {\n      token0 = tokens.filter(t => t.symbol === symbol)[0].address;\n      token1 = path[path.length - 1];\n    }\n\n    if (index === 1) {\n      token0 = path[0];\n      token1 = tokens.filter(t => t.symbol === symbol)[0].address;\n    }\n\n    if (token0 === token1) {\n      return false;\n    }\n\n    try {\n      setPath(pathFinder.findPath(token0, token1));\n      setAmount0(0);\n      setAmount1(0);\n    } catch {\n      alert(`${token0.symbol}/${token1.symbol} pair doesn't exist!`);\n    }\n  }\n\n  /**\n   * Toggles swap direction.\n   */\n  const toggleDirection = (e) => {\n    e.preventDefault();\n\n    setZeroForOne(!zeroForOne);\n    setPath(path.reverse());\n  }\n\n  const tokenByAddress = (address) => {\n    return tokens.filter(t => t.address === address)[0];\n  }\n\n  return (\n    <section className=\"SwapContainer\">\n      {addingLiquidity &&\n        <AddLiquidityForm\n          toggle={toggleAddLiquidityForm}\n          token0Info={tokens.filter(t => t.address === path[0])[0]}\n          token1Info={tokens.filter(t => t.address === path[2])[0]}\n          fee={path[1]} />}\n      {removingLiquidity &&\n        <RemoveLiquidityForm\n          toggle={toggleRemoveLiquidityForm}\n          token0Info={tokens.filter(t => t.address === path[0])[0]}\n          token1Info={tokens.filter(t => t.address === path[2])[0]}\n          fee={path[1]} />}\n      <header>\n        <h1>Swap tokens</h1>\n        <button disabled={!enabled || loading} onClick={toggleAddLiquidityForm}>Add liquidity</button>\n        <button disabled={!enabled || loading} onClick={toggleRemoveLiquidityForm}>Remove liquidity</button>\n      </header>\n      {path ?\n        <form className=\"SwapForm\">\n          <SwapInput\n            amount={zeroForOne ? amount0 : amount1}\n            disabled={!enabled || loading}\n            onChange={(ev) => selectToken(ev.target.value, 0)}\n            readOnly={false}\n            setAmount={setAmountFn(zeroForOne ? setAmount0 : setAmount1)}\n            token={tokenByAddress(path[0]).symbol}\n            tokens={tokens} />\n          <ChangeDirectionButton zeroForOne={zeroForOne} onClick={toggleDirection} disabled={!enabled || loading} />\n          <SwapInput\n            amount={zeroForOne ? amount1 : amount0}\n            disabled={!enabled || loading}\n            onChange={(ev) => selectToken(ev.target.value, 1)}\n            readOnly={true}\n            token={tokenByAddress(path[path.length - 1]).symbol}\n            tokens={tokens.filter(t => t.address !== path[0])} />\n          <SlippageControl\n            setSlippage={setSlippage}\n            slippage={slippage} />\n          <button className='swap' disabled={!enabled || loading} onClick={swap}>Swap</button>\n        </form>\n        :\n        <span>Loading pairs...</span>}\n    </section>\n  )\n}\n\nexport default SwapForm;"],"mappings":"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"},"metadata":{},"sourceType":"module"}